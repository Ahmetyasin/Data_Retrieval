{
  "version": "20231227",
  "url": "https://www.imdb.com/title/%(imdb_id)s/reference",
  "rules": [
    {
      "key": "imdb_id",
      "extractor": {
        "path": "//meta[@property='pageId']/@content"
      }
    },
    {
      "key": "type_id",
      "extractor": {
        "path": "//h3[@itemprop='name']/following-sibling::ul/li[last()]/text()",
        "transform": "type_id"
      }
    },
    {
      "key": "title",
      "extractor": {
        "path": "//h3[@itemprop='name']/text()",
        "transform": "strip"
      }
    },
    {
      "key": "title",
      "extractor": {
        "path": "//span[@class='titlereference-original-title-label']/preceding-sibling::text()",
        "transform": "strip"
      }
    },
    {
      "key": "_year",
      "extractor": {
        "path": "//span[@class='titlereference-title-year']//a/text()",
        "transform": "year_range",
        "post_map": [
          {
            "key": "year",
            "extractor": {
              "path": "year"
            }
          },
          {
            "key": "end_year",
            "extractor": {
              "path": "end_year"
            }
          }
        ]
      }
    },
    {
      "key": "runtime",
      "extractor": {
        "path": "//td[text()='Runtime']/..//li/text()",
        "transform": "runtime"
      }
    },
    {
      "key": "rating",
      "extractor": {
        "path": "//div[@class='ipl-rating-star ']//span[@class='ipl-rating-star__rating']/text()",
        "transform": "decimal"
      }
    },
    {
      "key": "vote_count",
      "extractor": {
        "path": "//span[@class='ipl-rating-star__total-votes']/text()",
        "transform": "vote_count"
      }
    },
    {
      "key": "genres",
      "extractor": {
        "foreach": "//td[text()='Genres']/..//li/a",
        "path": "./text()"
      }
    },
    {
      "key": "plot",
      "extractor": {
        "rules": [
          {
            "key": "lang",
            "extractor": {
              "path": "//script/text()",
              "transform": "locale"
            }
          },
          {
            "key": "text",
            "extractor": {
              "path": "//section[@class='titlereference-section-overview']/div[1]/text()",
              "transform": "strip"
            }
          }
        ],
        "transform": "lang"
      }
    },
    {
      "foreach": "//h4[@id]",
      "key": {
        "path": "./@id",
        "transform": "credit_section_id"
      },
      "extractor": {
        "foreach": "./ancestor::header/following-sibling::table[1]//tr//a",
        "rules": [
          {
            "key": "imdb_id",
            "extractor": {
              "path": "./@href",
              "transform": "href_id"
            }
          },
          {
            "key": "name",
            "extractor": {
              "path": "./text()"
            }
          },
          {
            "key": "_notes",
            "extractor": {
              "path": ".//ancestor::tr/td[text()='...']/following-sibling::td/text()",
              "transform": "credit_info",
              "post_map": [
                {
                  "key": "job",
                  "extractor": {
                    "path": "job"
                  }
                },
                {
                  "key": "as_name",
                  "extractor": {
                    "path": "as_name"
                  }
                },
                {
                  "key": "uncredited",
                  "extractor": {
                    "path": "uncredited"
                  }
                },
                {
                  "key": "notes",
                  "extractor": {
                    "path": "notes"
                  }
                }
              ]
            }
          }
        ]
      }
    }
  ]
}
